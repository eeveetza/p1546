%% validation example: srg_lan_637 
d = [0, 0.047, 0.052, 0.115, 0.129, 0.178, 0.211, 0.242, 0.293, 0.305, 0.368, 0.374, 0.431, 0.456, 0.494, 0.538, 0.558, 0.619, 0.610, 0.637];
h = [543.7,540.8,540.6,528,523.2,505.8,492.8,478.5,458.9,455.3,440.3,439.4,432.2,430.3,428.7,426.1,425.8,427.9,427.9,428.1];
zone = ones(size(d)); %land only

PTx = 10;  % kW
f = 562;   % MHz
t = 50;    % %
h1 = 95.5; % m
h2 = 3.34; % m
R1 = 0;    % m
R2 = 0;    % m
area2 = 'Suburban';

[E, L] = tl_p1546_profile(f, t, d, h, zone, h1, h2, R1, R2, area2, 'PTx', PTx);

Lref = 111.54222929;
Eref = 92.75249702;

tol = 1e-4;
if (abs(E-Eref) < tol && abs(L-Lref)<tol)
    fprintf(1,'Test1 passed.\n');
else
    fprintf(1,'Test1 failed. Deviation larger than tolerance %f\n', tol);
end


%% validation example: b2iseac
d = [0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8	2	2.5	3	3.5	4	4.5	5	5.5	6	6.5	7	7.5	8	8.5	9	9.5	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40	41	42	43	44	45	46	47	48	49	50	51	52	53	54	55	56	57	58	59	60	62	64	66	68	70	72	74	76	78	80	82	84	86	88	90	92	94	96	98	100	102	104	106	108	110	112	114	116	117.6	119.1	121.1	123.1	125.1	127.1	129.1	131.1	133.1	135.1	137.1	139.1	141.1	143.1	145.1	147.1	149.1	151.1	153.1	155.1	157.1	159.1	161.1	163.1	165.1	167.1	169.1	171.1	173.1	175.1	176.1	177.1	178.1	179.1	180.1	181.1	182.1	183.1	184.1	185.1	186.1	187.1	188.1	189.1	190.1	191.1	192.1	193.1	194.1	195.1	196.1	197.1	198.1	199.1	200.1	201.1	202.1	203.1	204.1	205.1	206.1	207.1	208.1	209.1	210.1	211.1	212.1	213.1	214.1	215.1	216.1	217.1	218.1	219.1	220.1	221.1	222.1	223.1	224.1	225.1	225.6	226.1	226.6	227.1	227.6	228.1	228.6	229.1	229.6	230.1	230.6	231.1	231.6	232.1	232.6	233.1	233.3	233.5	233.7	233.9	234.1	234.3	234.5	234.7	234.9	235.1];
h = [754.4	754.4	729.9	685.3	634.3	610.3	601	591.7	530.4	455.9	385.1	373.4	358.5	309	316.6	335.3	408.1	532.7	556.3	556.3	488.2	367.7	304.8	292.6	238.3	265.1	250.3	182.2	129.5	145.8	61	36.5	26.7	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	4.1	6.4	8.3	0	0	5.4	7.2	14.7	24.8	28.9	32.7	38.7	47.6	56.6	73.1	97.2	92.8	97.4	111.3];
zone = [1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2	2]; %land = 1, sea = 2, cold = 3, warm = 4

f = 95.3;   % MHz
t = 1;      % %
h1 = 60;    % m
h2 = 7;     % m
R1 = 10;    % m
R2 = 0;     % m
area2 = 'Rural';

[E, L] = tl_p1546_profile(f, t, d, h, zone, h1, h2, R1, R2, area2);

Lref = 146.44983945;
Eref = 32.43201856;

tol = 1e-4;
if (abs(E-Eref) < tol && abs(L-Lref)<tol)
    fprintf(1,'Test2 passed.\n');
else
    fprintf(1,'Test2 failed. Deviation larger than tolerance %f\n', tol);
end